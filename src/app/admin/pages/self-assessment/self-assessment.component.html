<nz-card nzTitle="{{ 'TỰ ĐÁNH GIÁ' }}">
  <p style="font-size: 14px;color: rgba(0, 0, 0, 0.85);margin-bottom: 16px;font-weight: 500;">
    Khai báo:
    <nz-select ngModel="{{ currentMonth }}" style="margin: 0 8px 10px 0; width: 120px">
      <nz-option nzLabel="{{ month.label }}" *ngFor="let month of months" nzValue="{{ month.value }}"></nz-option>
    </nz-select>
  </p>

  <ul nz-list [nzDataSource]="createdSelfCriticism.assessmentCriterias" nzBordered nzSize="large">
    <nz-list-header>
      <div class="flex">
        <div class="flex-1">Nội dung công việc đã làm</div>
        <div class="justify-end items-end">
          <button nz-button nzType="primary" nzSize="large" nzShape="round" (click)="addAssessmentToList()">
            + Khai báo
          </button>
        </div>
      </div>
    </nz-list-header>

    <li nz-list-item *ngFor="let item of createdSelfCriticism.assessmentCriterias;let i = index">
      <div class="flex flex-col flex-1 gap-4">
        <div class="sm:grid sm:grid-cols-1 md:grid md:grid-cols-12 flex-1 md:gap-2">
          <div class="col-span-1 align-center">
            <nz-tag nzColor="processing">{{ i + 1 }}</nz-tag>
          </div>
          <div class="col-span-10">
            <div class="sm:grid sm:grid-cols-1 md:grid md:grid-cols-12 flex-1 md:gap-2">
              <div class="col-span-4">
                <nz-select class="max-w-50%" [(ngModel)]="item.assessmentCriteriaGroupId"
                           (ngModelChange)="selectChangeAssessmentCriteriaGroup($event, i)"
                           nzPlaceHolder="Chọn nhóm tiêu chí đánh giá">
                  <nz-option *ngFor="let assessmentCriteriaGroup of item?.assessmentCriteriaGroups"
                             [nzValue]="assessmentCriteriaGroup.id" [nzLabel]="assessmentCriteriaGroup.name">
                  </nz-option>
                </nz-select>
              </div>
              <div class="col-span-4">
                <ng-container *ngIf=" item?.assessmentCriteria1 == null || item?.assessmentCriteria1?.length == 0">
                  <input type="text" nz-input placeholder="Nhập tiêu chí đánh giá" [(ngModel)]="item.name"/>
                </ng-container>
                <ng-container *ngIf=" item?.assessmentCriteria1 != null &&  item.assessmentCriteria1.length >= 1">
                  <nz-select class="max-w-50%" nzPlaceHolder="Chọn tiêu chí đánh giá"
                             (ngModelChange)="changeValueOfIndexAssessment($event, i)"
                             [(ngModel)]="item.id">
                    <nz-option
                      *ngFor="let assessment of item?.assessmentCriteria1" [nzValue]="assessment.id"
                      [nzLabel]="assessment.name">
                    </nz-option>
                  </nz-select>
                </ng-container>
              </div>
              <div class="col-span-2">
                <nz-date-picker nzMode="date" [(ngModel)]="item.actionDate"></nz-date-picker>
              </div>
              <div class="col-span-1">
                <ng-container *ngIf=" item?.assessmentCriteria1 == null || item?.assessmentCriteria1?.length == 0">
                  <nz-input-number [(ngModel)]="item.value" nzPlaceHolder="Nhập điểm"></nz-input-number>
                </ng-container>
                <ng-container *ngIf=" item?.assessmentCriteria1 != null &&  item.assessmentCriteria1.length >= 1">
                  <nz-input-number [(ngModel)]="item.quantity" nzPlaceHolder="Nhập số lần"></nz-input-number>
                </ng-container>
              </div>
              <div class="col-span-1"></div>
            </div>
            <!--<div
              class="sm:grid sm:grid-cols-1 md:grid md:grid-cols-12 flex-1 md:gap-2 mt-2"
            >
              <div class="col-span-4">
                <input nz-input placeholder="Mô tả thêm" [(ngModel)]="item.description"/>
              </div>
              <div class="col-span-4"></div>
              <div class="col-span-2"></div>
              <div class="col-span-1">
                <nz-input-number *ngIf="selectedAssessmentCriteria[i].allowUpdateScore === true"
                                 [(ngModel)]="selectedAssessmentCriteria[i].value"
                                 [nzStep]="1"
                                 (change)="calculateTotal()"
                ></nz-input-number>
              </div>
              <div class="col-span-1"></div>
            </div>-->
          </div>
          <div class="col-span-1">
            <button
              nz-button
              nzType="default"
              nzDanger
              (click)="removeAssessment(i)"
            >
              Xóa
            </button>
          </div>
        </div>
      </div>
    </li>
    <nz-list-footer>
      <div class="flex justify-end items-end mb-3">
        <div class=" border rounded px-3 py-1">
          Tổng điểm: {{ calculateTotal() }}
        </div>
      </div>
      <div class="flex justify-end items-end mb-3">
        <div class=" border rounded px-3 py-1">
          Xếp loại: {{ getGradeName() }}
        </div>
      </div>
    </nz-list-footer>
  </ul>

  <nz-divider nzType="vertical"></nz-divider>

  <div style="text-align: end">
    <button
      nz-button
      nzType="dashed"
      nzSize="large"
      nzShape="round"
      (click)="createSelfCriticism(createdSelfCriticism)"
    >
      Lưu bản ghi
    </button>
  </div>
</nz-card>
